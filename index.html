<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nezeex Store | ĞšÑƒĞ¿Ğ¸Ñ‚ÑŒ Telegram Ğ°ĞºĞºĞ°ÑƒĞ½Ñ‚Ñ‹</title>
    <style>
        /* Ğ’ÑĞµ ÑÑ‚Ğ¸Ğ»Ğ¸ Ğ¾ÑÑ‚Ğ°ÑÑ‚ÑÑ Ñ‚Ğ°ĞºĞ¸Ğ¼Ğ¸ Ğ¶Ğµ ĞºĞ°Ğº Ğ² Ğ¿Ñ€ĞµĞ´Ñ‹Ğ´ÑƒÑ‰ĞµĞ¼ ĞºĞ¾Ğ´Ğµ */
        /* ... ÑÑ‚Ğ¸Ğ»Ğ¸ ... */
    </style>
</head>
<body>
    <div class="container">
        <!-- Ğ’ĞµÑÑŒ HTML ĞºĞ¾Ğ´ Ğ¾ÑÑ‚Ğ°ĞµÑ‚ÑÑ Ñ‚Ğ°ĞºĞ¸Ğ¼ Ğ¶Ğµ ĞºĞ°Ğº Ğ² Ğ¿Ñ€ĞµĞ´Ñ‹Ğ´ÑƒÑ‰ĞµĞ¼ ĞºĞ¾Ğ´Ğµ -->
        <!-- ... HTML ... -->
        
        <script>
            // Ğ˜Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
            let users = JSON.parse(localStorage.getItem('users') || '[]');
            let currentUser = JSON.parse(localStorage.getItem('currentUser') || 'null');
            let currentPurchase = null;
            let statistics = JSON.parse(localStorage.getItem('statistics') || '{"totalSales": 0, "totalRevenue": 0, "todaySales": 0, "promoUsed": 0}');
            let currentPaymentMethod = 'card';
            let activePromoCode = null;
            let appliedDiscount = 0;
            let deliveryCodes = JSON.parse(localStorage.getItem('deliveryCodes') || '{}');
            let pendingOrders = JSON.parse(localStorage.getItem('pendingOrders') || '[]');
            let generatedCodes = JSON.parse(localStorage.getItem('generatedCodes') || '[]');

            // Ğ”Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ¿Ñ€Ğ¾Ğ¼Ğ¾ĞºĞ¾Ğ´Ğ¾Ğ²
            let promoCodes = JSON.parse(localStorage.getItem('promoCodes') || '[]');

            // ĞšÑƒÑ€ÑÑ‹ ĞºÑ€Ğ¸Ğ¿Ñ‚Ğ¾Ğ²Ğ°Ğ»ÑÑ‚
            const cryptoRates = {
                USDT: 78,
                TON: 120
            };

            // ĞŸĞ¾Ğ»Ğ½Ñ‹Ğ¹ ÑĞ¿Ğ¸ÑĞ¾Ğº Ğ²ÑĞµÑ… ÑÑ‚Ñ€Ğ°Ğ½ Ñ ĞºĞ¾Ğ´Ğ°Ğ¼Ğ¸ Ğ¸ Ñ†ĞµĞ½Ğ°Ğ¼Ğ¸
            const allCountries = [
                { code: "+1", flag: "ğŸ‡ºğŸ‡¸", name: "Ğ¡Ğ¨Ğ", price: 30, usd: 0.46, key: "usa" },
                { code: "+1ca", flag: "ğŸ‡¨ğŸ‡¦", name: "ĞšĞ°Ğ½Ğ°Ğ´Ğ°", price: 35, usd: 0.46, key: "canada" },
                { code: "+7", flag: "ğŸ‡·ğŸ‡º", name: "Ğ Ğ¾ÑÑĞ¸Ñ", price: 199, usd: 3.90, key: "russia" },
                { code: "+7kz", flag: "ğŸ‡°ğŸ‡¿", name: "ĞšĞ°Ğ·Ğ°Ñ…ÑÑ‚Ğ°Ğ½", price: 175, usd: 2.28, key: "kazakhstan" },
                { code: "+20", flag: "ğŸ‡ªğŸ‡¬", name: "Ğ•Ğ³Ğ¸Ğ¿ĞµÑ‚", price: 50, usd: 0.65, key: "egypt" },
                { code: "+27", flag: "ğŸ‡¿ğŸ‡¦", name: "Ğ®ĞĞ ", price: 100, usd: 1.30, key: "south-africa" },
                { code: "+30", flag: "ğŸ‡¬ğŸ‡·", name: "Ğ“Ñ€ĞµÑ†Ğ¸Ñ", price: 175, usd: 2.28, key: "greece" },
                { code: "+31", flag: "ğŸ‡³ğŸ‡±", name: "ĞĞ¸Ğ´ĞµÑ€Ğ»Ğ°Ğ½Ğ´Ñ‹", price: 275, usd: 3.58, key: "netherlands" },
                { code: "+32", flag: "ğŸ‡§ğŸ‡ª", name: "Ğ‘ĞµĞ»ÑŒĞ³Ğ¸Ñ", price: 1200, usd: 15.60, key: "belgium" },
                { code: "+33", flag: "ğŸ‡«ğŸ‡·", name: "Ğ¤Ñ€Ğ°Ğ½Ñ†Ğ¸Ñ", price: 250, usd: 3.25, key: "france" },
                { code: "+34", flag: "ğŸ‡ªğŸ‡¸", name: "Ğ˜ÑĞ¿Ğ°Ğ½Ğ¸Ñ", price: 250, usd: 3.25, key: "spain" },
                { code: "+36", flag: "ğŸ‡­ğŸ‡º", name: "Ğ’ĞµĞ½Ğ³Ñ€Ğ¸Ñ", price: 250, usd: 3.25, key: "hungary" },
                { code: "+39", flag: "ğŸ‡®ğŸ‡¹", name: "Ğ˜Ñ‚Ğ°Ğ»Ğ¸Ñ", price: 600, usd: 7.80, key: "italy" },
                { code: "+40", flag: "ğŸ‡·ğŸ‡´", name: "Ğ ÑƒĞ¼Ñ‹Ğ½Ğ¸Ñ", price: 80, usd: 1.04, key: "romania" },
                { code: "+41", flag: "ğŸ‡¨ğŸ‡­", name: "Ğ¨Ğ²ĞµĞ¹Ñ†Ğ°Ñ€Ğ¸Ñ", price: 2000, usd: 26.00, key: "switzerland" },
                { code: "+43", flag: "ğŸ‡¦ğŸ‡¹", name: "ĞĞ²ÑÑ‚Ñ€Ğ¸Ñ", price: 1000, usd: 13.00, key: "austria" },
                { code: "+44", flag: "ğŸ‡¬ğŸ‡§", name: "Ğ’ĞµĞ»Ğ¸ĞºĞ¾Ğ±Ñ€Ğ¸Ñ‚Ğ°Ğ½Ğ¸Ñ", price: 125, usd: 1.63, key: "uk" },
                { code: "+45", flag: "ğŸ‡©ğŸ‡°", name: "Ğ”Ğ°Ğ½Ğ¸Ñ", price: 1150, usd: 14.95, key: "denmark" },
                { code: "+46", flag: "ğŸ‡¸ğŸ‡ª", name: "Ğ¨Ğ²ĞµÑ†Ğ¸Ñ", price: 400, usd: 5.20, key: "sweden" },
                { code: "+47", flag: "ğŸ‡³ğŸ‡´", name: "ĞĞ¾Ñ€Ğ²ĞµĞ³Ğ¸Ñ", price: 1150, usd: 14.95, key: "norway" },
                { code: "+48", flag: "ğŸ‡µğŸ‡±", name: "ĞŸĞ¾Ğ»ÑŒÑˆĞ°", price: 275, usd: 3.58, key: "poland" },
                { code: "+49", flag: "ğŸ‡©ğŸ‡ª", name: "Ğ“ĞµÑ€Ğ¼Ğ°Ğ½Ğ¸Ñ", price: 300, usd: 3.90, key: "germany" },
                { code: "+51", flag: "ğŸ‡µğŸ‡ª", name: "ĞŸĞµÑ€Ñƒ", price: 150, usd: 1.95, key: "peru" },
                { code: "+52", flag: "ğŸ‡²ğŸ‡½", name: "ĞœĞµĞºÑĞ¸ĞºĞ°", price: 120, usd: 1.56, key: "mexico" },
                { code: "+53", flag: "ğŸ‡¨ğŸ‡º", name: "ĞšÑƒĞ±Ğ°", price: 180, usd: 2.34, key: "cuba" },
                { code: "+54", flag: "ğŸ‡¦ğŸ‡·", name: "ĞÑ€Ğ³ĞµĞ½Ñ‚Ğ¸Ğ½Ğ°", price: 130, usd: 1.69, key: "argentina" },
                { code: "+55", flag: "ğŸ‡§ğŸ‡·", name: "Ğ‘Ñ€Ğ°Ğ·Ğ¸Ğ»Ğ¸Ñ", price: 125, usd: 1.63, key: "brazil" },
                { code: "+56", flag: "ğŸ‡¨ğŸ‡±", name: "Ğ§Ğ¸Ğ»Ğ¸", price: 140, usd: 1.82, key: "chile" },
                { code: "+57", flag: "ğŸ‡¨ğŸ‡´", name: "ĞšĞ¾Ğ»ÑƒĞ¼Ğ±Ğ¸Ñ", price: 75, usd: 0.98, key: "colombia" },
                { code: "+58", flag: "ğŸ‡»ğŸ‡ª", name: "Ğ’ĞµĞ½ĞµÑÑƒÑĞ»Ğ°", price: 90, usd: 1.17, key: "venezuela" },
                { code: "+60", flag: "ğŸ‡²ğŸ‡¾", name: "ĞœĞ°Ğ»Ğ°Ğ¹Ğ·Ğ¸Ñ", price: 95, usd: 1.24, key: "malaysia" },
                { code: "+61", flag: "ğŸ‡¦ğŸ‡º", name: "ĞĞ²ÑÑ‚Ñ€Ğ°Ğ»Ğ¸Ñ", price: 110, usd: 1.43, key: "australia" },
                { code: "+62", flag: "ğŸ‡®ğŸ‡©", name: "Ğ˜Ğ½Ğ´Ğ¾Ğ½ĞµĞ·Ğ¸Ñ", price: 50, usd: 0.65, key: "indonesia" },
                { code: "+63", flag: "ğŸ‡µğŸ‡­", name: "Ğ¤Ğ¸Ğ»Ğ¸Ğ¿Ğ¿Ğ¸Ğ½Ñ‹", price: 65, usd: 0.84, key: "philippines" },
                { code: "+64", flag: "ğŸ‡³ğŸ‡¿", name: "ĞĞ¾Ğ²Ğ°Ñ Ğ—ĞµĞ»Ğ°Ğ½Ğ´Ğ¸Ñ", price: 115, usd: 1.50, key: "new-zealand" },
                { code: "+66", flag: "ğŸ‡¹ğŸ‡­", name: "Ğ¢Ğ°Ğ¸Ğ»Ğ°Ğ½Ğ´", price: 70, usd: 0.91, key: "thailand" },
                { code: "+81", flag: "ğŸ‡¯ğŸ‡µ", name: "Ğ¯Ğ¿Ğ¾Ğ½Ğ¸Ñ", price: 500, usd: 6.50, key: "japan" },
                { code: "+82", flag: "ğŸ‡°ğŸ‡·", name: "Ğ®Ğ¶Ğ½Ğ°Ñ ĞšĞ¾Ñ€ĞµÑ", price: 450, usd: 5.85, key: "south-korea" },
                { code: "+84", flag: "ğŸ‡»ğŸ‡³", name: "Ğ’ÑŒĞµÑ‚Ğ½Ğ°Ğ¼", price: 70, usd: 0.91, key: "vietnam" },
                { code: "+86", flag: "ğŸ‡¨ğŸ‡³", name: "ĞšĞ¸Ñ‚Ğ°Ğ¹", price: 750, usd: 9.75, key: "china" },
                { code: "+90", flag: "ğŸ‡¹ğŸ‡·", name: "Ğ¢ÑƒÑ€Ñ†Ğ¸Ñ", price: 100, usd: 1.30, key: "turkey" },
                { code: "+91", flag: "ğŸ‡®ğŸ‡³", name: "Ğ˜Ğ½Ğ´Ğ¸Ñ", price: 40, usd: 0.52, key: "india" },
                { code: "+92", flag: "ğŸ‡µğŸ‡°", name: "ĞŸĞ°ĞºĞ¸ÑÑ‚Ğ°Ğ½", price: 70, usd: 0.91, key: "pakistan" },
                { code: "+93", flag: "ğŸ‡¦ğŸ‡«", name: "ĞÑ„Ğ³Ğ°Ğ½Ğ¸ÑÑ‚Ğ°Ğ½", price: 75, usd: 0.98, key: "afghanistan" },
                { code: "+94", flag: "ğŸ‡±ğŸ‡°", name: "Ğ¨Ñ€Ğ¸-Ğ›Ğ°Ğ½ĞºĞ°", price: 100, usd: 1.30, key: "sri-lanka" },
                { code: "+95", flag: "ğŸ‡²ğŸ‡²", name: "ĞœÑŒÑĞ½Ğ¼Ğ°", price: 35, usd: 0.46, key: "myanmar" },
                { code: "+98", flag: "ğŸ‡®ğŸ‡·", name: "Ğ˜Ñ€Ğ°Ğ½", price: 175, usd: 2.28, key: "iran" },
                { code: "+212", flag: "ğŸ‡²ğŸ‡¦", name: "ĞœĞ°Ñ€Ğ¾ĞºĞºĞ¾", price: 75, usd: 0.98, key: "morocco" },
                { code: "+213", flag: "ğŸ‡©ğŸ‡¿", name: "ĞĞ»Ğ¶Ğ¸Ñ€", price: 85, usd: 1.11, key: "algeria" },
                { code: "+216", flag: "ğŸ‡¹ğŸ‡³", name: "Ğ¢ÑƒĞ½Ğ¸Ñ", price: 90, usd: 1.17, key: "tunisia" },
                { code: "+218", flag: "ğŸ‡±ğŸ‡¾", name: "Ğ›Ğ¸Ğ²Ğ¸Ñ", price: 95, usd: 1.24, key: "libya" },
                { code: "+225", flag: "ğŸ‡¨ğŸ‡®", name: "ĞšĞ¾Ñ‚-Ğ´'Ğ˜Ğ²ÑƒĞ°Ñ€", price: 750, usd: 9.75, key: "ivory-coast" },
                { code: "+233", flag: "ğŸ‡¬ğŸ‡­", name: "Ğ“Ğ°Ğ½Ğ°", price: 550, usd: 7.15, key: "ghana" },
                { code: "+234", flag: "ğŸ‡³ğŸ‡¬", name: "ĞĞ¸Ğ³ĞµÑ€Ğ¸Ñ", price: 45, usd: 0.59, key: "nigeria" },
                { code: "+251", flag: "ğŸ‡ªğŸ‡¹", name: "Ğ­Ñ„Ğ¸Ğ¾Ğ¿Ğ¸Ñ", price: 60, usd: 0.78, key: "ethiopia" },
                { code: "+254", flag: "ğŸ‡°ğŸ‡ª", name: "ĞšĞµĞ½Ğ¸Ñ", price: 40, usd: 0.52, key: "kenya" },
                { code: "+255", flag: "ğŸ‡¹ğŸ‡¿", name: "Ğ¢Ğ°Ğ½Ğ·Ğ°Ğ½Ğ¸Ñ", price: 55, usd: 0.72, key: "tanzania" },
                { code: "+249", flag: "ğŸ‡¸ğŸ‡©", name: "Ğ¡ÑƒĞ´Ğ°Ğ½", price: 65, usd: 0.85, key: "sudan" },
                { code: "+373", flag: "ğŸ‡²ğŸ‡©", name: "ĞœĞ¾Ğ»Ğ´Ğ¾Ğ²Ğ°", price: 175, usd: 2.28, key: "moldova" },
                { code: "+374", flag: "ğŸ‡¦ğŸ‡²", name: "ĞÑ€Ğ¼ĞµĞ½Ğ¸Ñ", price: 400, usd: 5.20, key: "armenia" },
                { code: "+375", flag: "ğŸ‡§ğŸ‡¾", name: "Ğ‘ĞµĞ»Ğ°Ñ€ÑƒÑÑŒ", price: 170, usd: 2.21, key: "belarus" },
                { code: "+380", flag: "ğŸ‡ºğŸ‡¦", name: "Ğ£ĞºÑ€Ğ°Ğ¸Ğ½Ğ°", price: 235, usd: 3.06, key: "ukraine" },
                { code: "+972", flag: "ğŸ‡®ğŸ‡±", name: "Ğ˜Ğ·Ñ€Ğ°Ğ¸Ğ»ÑŒ", price: 180, usd: 2.34, key: "israel" },
                { code: "+971", flag: "ğŸ‡¦ğŸ‡ª", name: "ĞĞĞ­", price: 200, usd: 2.60, key: "uae" },
                { code: "+966", flag: "ğŸ‡¸ğŸ‡¦", name: "Ğ¡Ğ°ÑƒĞ´Ğ¾Ğ²ÑĞºĞ°Ñ ĞÑ€Ğ°Ğ²Ğ¸Ñ", price: 190, usd: 2.47, key: "saudi-arabia" },
                { code: "+965", flag: "ğŸ‡°ğŸ‡¼", name: "ĞšÑƒĞ²ĞµĞ¹Ñ‚", price: 210, usd: 2.73, key: "kuwait" },
                { code: "+974", flag: "ğŸ‡¶ğŸ‡¦", name: "ĞšĞ°Ñ‚Ğ°Ñ€", price: 220, usd: 2.86, key: "qatar" },
                { code: "+968", flag: "ğŸ‡´ğŸ‡²", name: "ĞĞ¼Ğ°Ğ½", price: 205, usd: 2.67, key: "oman" },
                { code: "+995", flag: "ğŸ‡¬ğŸ‡ª", name: "Ğ“Ñ€ÑƒĞ·Ğ¸Ñ", price: 160, usd: 2.08, key: "georgia" },
                { code: "+998", flag: "ğŸ‡ºğŸ‡¿", name: "Ğ£Ğ·Ğ±ĞµĞºĞ¸ÑÑ‚Ğ°Ğ½", price: 155, usd: 2.02, key: "uzbekistan" },
                { code: "+992", flag: "ğŸ‡¹ğŸ‡¯", name: "Ğ¢Ğ°Ğ´Ğ¶Ğ¸ĞºĞ¸ÑÑ‚Ğ°Ğ½", price: 145, usd: 1.89, key: "tajikistan" },
                { code: "+993", flag: "ğŸ‡¹ğŸ‡²", name: "Ğ¢ÑƒÑ€ĞºĞ¼ĞµĞ½Ğ¸ÑÑ‚Ğ°Ğ½", price: 150, usd: 1.95, key: "turkmenistan" },
                { code: "+994", flag: "ğŸ‡¦ğŸ‡¿", name: "ĞĞ·ĞµÑ€Ğ±Ğ°Ğ¹Ğ´Ğ¶Ğ°Ğ½", price: 165, usd: 2.15, key: "azerbaijan" }
            ];

            // Ğ”Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ¿Ñ€ĞµĞ¼Ğ¸ÑƒĞ¼ Ğ°ĞºĞºĞ°ÑƒĞ½Ñ‚Ğ¾Ğ²
            let premiumAccounts = JSON.parse(localStorage.getItem('premiumAccounts') || '[]');
            if (premiumAccounts.length === 0) {
                premiumAccounts = [
                    {
                        id: 'usa-premium',
                        country: 'Ğ¡Ğ¨Ğ',
                        price: 500,
                        endDate: '2025-01-01',
                        countryKey: 'usa'
                    },
                    {
                        id: 'russia-premium',
                        country: 'Ğ Ğ¾ÑÑĞ¸Ñ',
                        price: 1000,
                        endDate: '2025-01-01',
                        countryKey: 'russia'
                    }
                ];
                localStorage.setItem('premiumAccounts', JSON.stringify(premiumAccounts));
            }

            // Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ñ Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ ÑƒĞ½Ğ¸ĞºĞ°Ğ»ÑŒĞ½Ğ¾Ğ³Ğ¾ 8-ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»ÑŒĞ½Ğ¾Ğ³Ğ¾ ĞºĞ¾Ğ´Ğ° Ñ ĞºĞ¾Ğ´Ğ¾Ğ¼ ÑÑ‚Ñ€Ğ°Ğ½Ñ‹ Ğ² ĞºĞ¾Ğ½Ñ†Ğµ
            function generateUniqueCode(countryCode) {
                // Ğ“ĞµĞ½ĞµÑ€Ğ¸Ñ€ÑƒĞµĞ¼ 8 ÑĞ»ÑƒÑ‡Ğ°Ğ¹Ğ½Ñ‹Ñ… ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ğ¾Ğ² (Ğ±ÑƒĞºĞ²Ñ‹ Ğ¸ Ñ†Ğ¸Ñ„Ñ€Ñ‹)
                const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
                let baseCode = '';
                for (let i = 0; i < 8; i++) {
                    baseCode += chars.charAt(Math.floor(Math.random() * chars.length));
                }
                
                // Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ÑĞµĞ¼ ĞºĞ¾Ğ´ ÑÑ‚Ñ€Ğ°Ğ½Ñ‹ Ğ² ĞºĞ¾Ğ½ĞµÑ†
                const fullCode = baseCode + countryCode;
                return fullCode;
            }

            // Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ñ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ¸ ĞºĞ¾Ğ´Ğ° Ğ² Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ¾Ğµ Ñ…Ñ€Ğ°Ğ½Ğ¸Ğ»Ğ¸Ñ‰Ğµ (Ğ·Ğ°Ğ¼ĞµĞ½ÑĞµĞ¼ API Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ)
            function saveCodeToLocalStorage(code, countryInfo, price) {
                try {
                    // ĞŸĞ¾Ğ»ÑƒÑ‡Ğ°ĞµĞ¼ ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰Ğ¸Ğµ ĞºĞ¾Ğ´Ñ‹ Ğ¸Ğ»Ğ¸ ÑĞ¾Ğ·Ğ´Ğ°ĞµĞ¼ Ğ¿ÑƒÑÑ‚Ğ¾Ğ¹ Ğ¼Ğ°ÑÑĞ¸Ğ²
                    let codes = JSON.parse(localStorage.getItem('nezeex_codes') || '[]');
                    
                    // Ğ¡Ğ¾Ğ·Ğ´Ğ°ĞµĞ¼ Ğ¾Ğ±ÑŠĞµĞºÑ‚ ĞºĞ¾Ğ´Ğ°
                    const codeData = {
                        id: Date.now(),
                        code: code,
                        country: countryInfo.name,
                        countryCode: countryInfo.code,
                        countryKey: countryInfo.key,
                        price: price,
                        created: new Date().toISOString(),
                        status: 'active',
                        used: false,
                        orderId: null
                    };
                    
                    // Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ÑĞµĞ¼ ĞºĞ¾Ğ´ Ğ² Ğ¼Ğ°ÑÑĞ¸Ğ²
                    codes.push(codeData);
                    
                    // Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ÑĞµĞ¼ Ğ² localStorage
                    localStorage.setItem('nezeex_codes', JSON.stringify(codes));
                    
                    // Ğ¢Ğ°ĞºĞ¶Ğµ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ÑĞµĞ¼ Ğ² Ğ¾Ñ‚Ğ´ĞµĞ»ÑŒĞ½Ñ‹Ğ¹ Ğ¼Ğ°ÑÑĞ¸Ğ² Ğ´Ğ»Ñ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ¸
                    generatedCodes.push(codeData);
                    localStorage.setItem('generatedCodes', JSON.stringify(generatedCodes));
                    
                    console.log('ĞšĞ¾Ğ´ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½ Ğ² localStorage:', codeData);
                    return true;
                    
                } catch (error) {
                    console.error('ĞÑˆĞ¸Ğ±ĞºĞ° ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ñ ĞºĞ¾Ğ´Ğ° Ğ² localStorage:', error);
                    return false;
                }
            }

            // Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ñ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ¸, ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒĞµÑ‚ Ğ»Ğ¸ ĞºĞ¾Ğ´ Ğ² localStorage
            function checkCodeInLocalStorage(code) {
                try {
                    const codes = JSON.parse(localStorage.getItem('nezeex_codes') || '[]');
                    return codes.find(c => c.code === code);
                } catch (error) {
                    console.error('ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ¸ ĞºĞ¾Ğ´Ğ° Ğ² localStorage:', error);
                    return null;
                }
            }

            // Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ñ Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ Ğ¸ Ğ¿Ğ¾ĞºĞ°Ğ·Ğ° ĞºĞ¾Ğ´Ğ° (Ğ¸ÑĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ½Ğ°Ñ Ğ²ĞµÑ€ÑĞ¸Ñ)
            function generateAndShowCode() {
                try {
                    if (!currentPurchase) {
                        showNotification('ĞÑˆĞ¸Ğ±ĞºĞ°: Ğ½ĞµÑ‚ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ¾ Ğ¿Ğ¾ĞºÑƒĞ¿ĞºĞµ', 'error');
                        return false;
                    }

                    // ĞŸĞ¾Ğ»ÑƒÑ‡Ğ°ĞµĞ¼ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ¾ ÑÑ‚Ñ€Ğ°Ğ½Ğµ
                    let countryInfo = null;
                    
                    if (currentPurchase.accountKey.includes('premium')) {
                        const premiumAccount = premiumAccounts.find(a => a.id === currentPurchase.accountKey);
                        if (premiumAccount) {
                            countryInfo = allCountries.find(c => c.key === premiumAccount.countryKey);
                        }
                    } else if (currentPurchase.accountKey === 'usa-ot') {
                        countryInfo = allCountries.find(c => c.key === 'usa');
                    } else if (currentPurchase.accountKey === 'india-ot') {
                        countryInfo = allCountries.find(c => c.key === 'india');
                    } else {
                        countryInfo = allCountries.find(c => c.key === currentPurchase.accountKey);
                    }

                    if (!countryInfo) {
                        showNotification('ĞÑˆĞ¸Ğ±ĞºĞ°: Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ¾ ÑÑ‚Ñ€Ğ°Ğ½Ğµ Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ğ°', 'error');
                        return false;
                    }

                    // Ğ“ĞµĞ½ĞµÑ€Ğ¸Ñ€ÑƒĞµĞ¼ ÑƒĞ½Ğ¸ĞºĞ°Ğ»ÑŒĞ½Ñ‹Ğ¹ ĞºĞ¾Ğ´ Ñ ĞºĞ¾Ğ´Ğ¾Ğ¼ ÑÑ‚Ñ€Ğ°Ğ½Ñ‹ Ğ² ĞºĞ¾Ğ½Ñ†Ğµ
                    const generatedCode = generateUniqueCode(countryInfo.code);
                    
                    // Ğ Ğ°ÑÑÑ‡Ğ¸Ñ‚Ñ‹Ğ²Ğ°ĞµĞ¼ Ğ¸Ñ‚Ğ¾Ğ³Ğ¾Ğ²ÑƒÑ Ñ†ĞµĞ½Ñƒ
                    const finalPrice = currentPurchase.finalPrice || currentPurchase.price;
                    
                    // Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ÑĞµĞ¼ ĞºĞ¾Ğ´ Ğ² localStorage (Ğ²Ğ¼ĞµÑÑ‚Ğ¾ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ¸ Ğ² Ğ±Ğ¾Ñ‚)
                    const saved = saveCodeToLocalStorage(generatedCode, countryInfo, finalPrice);
                    
                    if (!saved) {
                        showNotification('ĞÑˆĞ¸Ğ±ĞºĞ° ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ñ ĞºĞ¾Ğ´Ğ°', 'error');
                        return false;
                    }
                    
                    // ĞŸĞ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµĞ¼ ĞºĞ¾Ğ´ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ
                    showGeneratedCodeModal(generatedCode, countryInfo, finalPrice);
                    
                    // ĞĞ±Ğ½Ğ¾Ğ²Ğ»ÑĞµĞ¼ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºÑƒ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ğ¿Ñ€Ğ¾Ğ¼Ğ¾ĞºĞ¾Ğ´Ğ°
                    if (activePromoCode) {
                        const promoIndex = promoCodes.findIndex(p => p.code === activePromoCode.code);
                        if (promoIndex !== -1) {
                            promoCodes[promoIndex].used += 1;
                            promoCodes[promoIndex].lastUsed = new Date().toISOString();
                            localStorage.setItem('promoCodes', JSON.stringify(promoCodes));
                        }
                    }
                    
                    // ĞĞ±Ğ½Ğ¾Ğ²Ğ»ÑĞµĞ¼ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºÑƒ
                    updateStatistics();
                    
                    // Ğ¡Ğ±Ñ€Ğ°ÑÑ‹Ğ²Ğ°ĞµĞ¼ Ğ¿Ñ€Ğ¾Ğ¼Ğ¾ĞºĞ¾Ğ´ Ğ¿Ğ¾ÑĞ»Ğµ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
                    resetPromoCode();
                    
                    // Ğ—Ğ°ĞºÑ€Ñ‹Ğ²Ğ°ĞµĞ¼ Ğ¼Ğ¾Ğ´Ğ°Ğ»ÑŒĞ½Ğ¾Ğµ Ğ¾ĞºĞ½Ğ¾ Ğ¾Ğ¿Ğ»Ğ°Ñ‚Ñ‹
                    closeModal();
                    
                    return true;
                    
                } catch (error) {
                    console.error('ĞÑˆĞ¸Ğ±ĞºĞ° Ğ² generateAndShowCode:', error);
                    showNotification('ĞŸÑ€Ğ¾Ğ¸Ğ·Ğ¾ÑˆĞ»Ğ° Ğ¾ÑˆĞ¸Ğ±ĞºĞ° Ğ¿Ñ€Ğ¸ Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ ĞºĞ¾Ğ´Ğ°', 'error');
                    return false;
                }
            }

            // Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ñ Ğ¿Ğ¾ĞºĞ°Ğ·Ğ° Ğ¼Ğ¾Ğ´Ğ°Ğ»ÑŒĞ½Ğ¾Ğ³Ğ¾ Ğ¾ĞºĞ½Ğ° Ñ ÑĞ³ĞµĞ½ĞµÑ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¼ ĞºĞ¾Ğ´Ğ¾Ğ¼
            function showGeneratedCodeModal(code, countryInfo, price) {
                try {
                    document.getElementById('generatedCodeValue').textContent = code;
                    document.getElementById('codeCountryInfo').innerHTML = `ğŸ“ <strong>Ğ¡Ñ‚Ñ€Ğ°Ğ½Ğ°:</strong> ${countryInfo.flag} ${countryInfo.name}`;
                    document.getElementById('codePriceInfo').innerHTML = `ğŸ’° <strong>Ğ¦ĞµĞ½Ğ°:</strong> ${price} Ñ€ÑƒĞ±.`;
                    document.getElementById('codeCountryCodeInfo').innerHTML = `ğŸ“ <strong>ĞšĞ¾Ğ´ ÑÑ‚Ñ€Ğ°Ğ½Ñ‹:</strong> ${countryInfo.code}`;
                    
                    // ĞŸĞ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµĞ¼ Ğ¼Ğ¾Ğ´Ğ°Ğ»ÑŒĞ½Ğ¾Ğµ Ğ¾ĞºĞ½Ğ¾
                    const modal = document.getElementById('generatedCodeModal');
                    modal.style.display = 'flex';
                    
                    // Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ÑĞµĞ¼ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‡Ğ¸Ğº Ğ´Ğ»Ñ ĞºĞ½Ğ¾Ğ¿ĞºĞ¸ ĞºĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
                    document.querySelector('.btn-primary').onclick = function() {
                        copyGeneratedCode();
                    };
                    
                } catch (error) {
                    console.error('ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¿Ğ¾ĞºĞ°Ğ·Ğ° Ğ¼Ğ¾Ğ´Ğ°Ğ»ÑŒĞ½Ğ¾Ğ³Ğ¾ Ğ¾ĞºĞ½Ğ°:', error);
                }
            }

            // Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ñ ĞºĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ ÑĞ³ĞµĞ½ĞµÑ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ¾Ğ³Ğ¾ ĞºĞ¾Ğ´Ğ°
            function copyGeneratedCode() {
                try {
                    const code = document.getElementById('generatedCodeValue').textContent;
                    navigator.clipboard.writeText(code).then(() => {
                        showNotification('ĞšĞ¾Ğ´ ÑĞºĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½ Ğ² Ğ±ÑƒÑ„ĞµÑ€ Ğ¾Ğ±Ğ¼ĞµĞ½Ğ°!', 'success');
                    }).catch(err => {
                        // Fallback Ğ´Ğ»Ñ ÑÑ‚Ğ°Ñ€Ñ‹Ñ… Ğ±Ñ€Ğ°ÑƒĞ·ĞµÑ€Ğ¾Ğ²
                        const textArea = document.createElement('textarea');
                        textArea.value = code;
                        document.body.appendChild(textArea);
                        textArea.select();
                        document.execCommand('copy');
                        document.body.removeChild(textArea);
                        showNotification('ĞšĞ¾Ğ´ ÑĞºĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½ Ğ² Ğ±ÑƒÑ„ĞµÑ€ Ğ¾Ğ±Ğ¼ĞµĞ½Ğ°!', 'success');
                    });
                } catch (error) {
                    console.error('ĞÑˆĞ¸Ğ±ĞºĞ° ĞºĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ ĞºĞ¾Ğ´Ğ°:', error);
                    showNotification('ĞÑˆĞ¸Ğ±ĞºĞ° ĞºĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ ĞºĞ¾Ğ´Ğ°', 'error');
                }
            }

            // Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ñ Ğ¿Ğ¾ĞºĞ°Ğ·Ğ° Ğ¼Ğ¾Ğ´Ğ°Ğ»ÑŒĞ½Ğ¾Ğ³Ğ¾ Ğ¾ĞºĞ½Ğ° Ñ ĞºĞ¾Ğ´Ğ¾Ğ¼ (Ğ¸Ğ· ĞºĞ½Ğ¾Ğ¿ĞºĞ¸ "Ğ¯ Ğ¾Ğ¿Ğ»Ğ°Ñ‚Ğ¸Ğ»")
            function showGeneratedCodeModalFromButton() {
                // ĞŸĞ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµĞ¼ Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºÑƒ
                showNotification('Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ ĞºĞ¾Ğ´Ğ°...', 'success');
                
                // ĞĞµĞ±Ğ¾Ğ»ÑŒÑˆĞ°Ñ Ğ·Ğ°Ğ´ĞµÑ€Ğ¶ĞºĞ° Ğ´Ğ»Ñ UX
                setTimeout(() => {
                    const success = generateAndShowCode();
                    if (!success) {
                        showNotification('ĞĞµ ÑƒĞ´Ğ°Ğ»Ğ¾ÑÑŒ ÑĞ³ĞµĞ½ĞµÑ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ ĞºĞ¾Ğ´. ĞŸĞ¾Ğ¿Ñ€Ğ¾Ğ±ÑƒĞ¹Ñ‚Ğµ ĞµÑ‰Ğµ Ñ€Ğ°Ğ·.', 'error');
                    }
                }, 500);
            }

            // ĞÑÑ‚Ğ°Ğ»ÑŒĞ½Ñ‹Ğµ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¸ Ğ¾ÑÑ‚Ğ°ÑÑ‚ÑÑ Ñ‚Ğ°ĞºĞ¸Ğ¼Ğ¸ Ğ¶Ğµ, Ğ½Ğ¾ Ñ Ğ½ĞµĞ±Ğ¾Ğ»ÑŒÑˆĞ¸Ğ¼Ğ¸ Ğ¸ÑĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸ÑĞ¼Ğ¸...

            // Ğ˜Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ°Ğ´Ğ¼Ğ¸Ğ½Ğ°
            function initAdmin() {
                if (!users.find(u => u.username === 'admin')) {
                    users.push({
                        username: 'admin',
                        password: 'admin123',
                        email: 'admin@system.com',
                        role: 'admin',
                        createdAt: new Date().toISOString()
                    });
                    localStorage.setItem('users', JSON.stringify(users));
                }
            }

            // Ğ˜Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ñ†ĞµĞ½ ÑÑ‚Ñ€Ğ°Ğ½
            function initCountryPrices() {
                const prices = JSON.parse(localStorage.getItem('countryPrices') || '{}');
                let hasNewData = false;

                allCountries.forEach(country => {
                    if (!prices[country.key]) {
                        prices[country.key] = country.price;
                        hasNewData = true;
                    }
                });

                if (hasNewData) {
                    localStorage.setItem('countryPrices', JSON.stringify(prices));
                }

                updateCountryDisplay();
            }

            // ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ¾Ñ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ ÑÑ‚Ñ€Ğ°Ğ½
            function updateCountryDisplay() {
                const prices = JSON.parse(localStorage.getItem('countryPrices') || '{}');
                const countriesGrid = document.getElementById('countriesGrid');
                if (!countriesGrid) return;
                
                countriesGrid.innerHTML = '';

                allCountries.forEach(country => {
                    const price = prices[country.key] || country.price;
                    const card = document.createElement('div');
                    card.className = 'country-card';
                    card.innerHTML = `
                        <div class="country-header">
                            <div class="country-info">
                                <div class="flag">${country.flag}</div>
                                <div>
                                    <div class="country-name">${country.name}</div>
                                    <div class="country-code">${country.code}</div>
                                </div>
                            </div>
                            <div class="country-price">${price}P</div>
                        </div>
                        <div class="country-details">
                            <div>~$${country.usd}</div>
                            <div>~0Ğ²13 Ğ°ĞºĞºĞ°ÑƒĞ½Ñ‚Ğ¾Ğ²</div>
                        </div>
                        <button class="btn btn-primary" style="width: 100%;"
                            onclick="buyAccount('${country.name}', '0Ğ²13', '${country.key}')">
                            <span>ğŸ›’</span> ĞšÑƒĞ¿Ğ¸Ñ‚ÑŒ
                        </button>
                    `;
                    countriesGrid.appendChild(card);
                });
            }

            // ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ¾Ñ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ Ğ¿Ñ€ĞµĞ¼Ğ¸ÑƒĞ¼ Ğ°ĞºĞºĞ°ÑƒĞ½Ñ‚Ğ¾Ğ²
            function updatePremiumDisplay() {
                premiumAccounts.forEach(account => {
                    const priceElement = document.getElementById(`price-${account.id}`);
                    const detailsElement = document.getElementById(`${account.id}-details`);

                    if (priceElement) {
                        priceElement.textContent = account.price + 'P';
                    }

                    if (detailsElement) {
                        const formattedDate = new Date(account.endDate).toLocaleDateString("ru-RU");
                        detailsElement.textContent = `ĞŸĞ¾Ğ´Ğ¿Ğ¸ÑĞºĞ° Ğ´Ğ¾: ${formattedDate}`;
                    }
                });
            }

            // ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ¸
            function updateStatistics() {
                try {
                    const deliveredOrders = pendingOrders.filter(o => o.status === 'delivered');
                    const today = new Date().toDateString();
                    const todayOrders = deliveredOrders.filter(o => new Date(o.createdAt).toDateString() === today);
                    const promoUsedOrders = deliveredOrders.filter(o => o.purchase && o.purchase.promoCode);

                    statistics.totalSales = deliveredOrders.length;
                    statistics.totalRevenue = deliveredOrders.reduce((sum, o) => sum + parseInt(o.purchase.finalPrice || o.purchase.price), 0);
                    statistics.todaySales = todayOrders.length;
                    statistics.promoUsed = promoUsedOrders.length;

                    localStorage.setItem('statistics', JSON.stringify(statistics));

                    // ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ¾Ñ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ´Ğ»Ñ Ğ°Ğ´Ğ¼Ğ¸Ğ½Ğ°
                    if (currentUser && currentUser.role === 'admin') {
                        const totalSalesEl = document.getElementById('totalSales');
                        const totalRevenueEl = document.getElementById('totalRevenue');
                        const promoUsedEl = document.getElementById('promoUsed');
                        const adminTotalSalesEl = document.getElementById('admin-total-sales');
                        const adminTodaySalesEl = document.getElementById('admin-today-sales');
                        const adminTotalRevenueEl = document.getElementById('admin-total-revenue');
                        const adminPromoUsedEl = document.getElementById('admin-promo-used');

                        if (totalSalesEl) totalSalesEl.textContent = statistics.totalSales;
                        if (totalRevenueEl) totalRevenueEl.textContent = statistics.totalRevenue + 'P';
                        if (promoUsedEl) promoUsedEl.textContent = statistics.promoUsed;
                        if (adminTotalSalesEl) adminTotalSalesEl.textContent = statistics.totalSales;
                        if (adminTodaySalesEl) adminTodaySalesEl.textContent = statistics.todaySales;
                        if (adminTotalRevenueEl) adminTotalRevenueEl.textContent = statistics.totalRevenue + 'P';
                        if (adminPromoUsedEl) adminPromoUsedEl.textContent = statistics.promoUsed;
                    }
                } catch (error) {
                    console.error('ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ñ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ¸:', error);
                }
            }

            // ĞŸĞ¾ĞºĞ°Ğ·Ğ°Ñ‚ÑŒ/ÑĞºÑ€Ñ‹Ñ‚ÑŒ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºÑƒ Ğ² Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ Ğ¾Ñ‚ Ñ€Ğ¾Ğ»Ğ¸
            function updateStatsVisibility() {
                const statsSection = document.getElementById('statsSection');
                if (statsSection) {
                    if (currentUser && currentUser.role === 'admin') {
                        statsSection.style.display = 'grid';
                    } else {
                        statsSection.style.display = 'none';
                    }
                }
            }

            // Ğ£Ğ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ñ
            function showNotification(message, type = 'success') {
                try {
                    const notification = document.getElementById('notification');
                    if (!notification) return;
                    
                    notification.textContent = message;
                    notification.className = `notification ${type}`;
                    notification.style.display = 'block';

                    setTimeout(() => {
                        notification.style.display = 'none';
                    }, 3000);
                } catch (error) {
                    console.error('ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¿Ğ¾ĞºĞ°Ğ·Ğ° ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ñ:', error);
                }
            }

            // Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° Ğ¿Ñ€Ğ¸ Ğ·Ğ°Ğ¿ÑƒÑĞºĞµ
            window.onload = function() {
                try {
                    initAdmin();
                    initCountryPrices();
                    updatePremiumDisplay();
                    updateStatistics();

                    if (currentUser) {
                        showUserMenu();
                        updateStatsVisibility();
                        if (currentUser.role === 'admin') {
                            const adminPanel = document.getElementById('adminPanel');
                            if (adminPanel) adminPanel.style.display = 'block';
                            loadCountryControls();
                            loadPromoCodes();
                        }
                    }
                } catch (error) {
                    console.error('ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¿Ñ€Ğ¸ Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞµ:', error);
                }
            };

            // ĞŸĞ¾ĞºĞ°Ğ·Ğ°Ñ‚ÑŒ Ğ¼ĞµĞ½Ñ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ
            function showUserMenu() {
                try {
                    const socialLinks = document.querySelector('.social-links');
                    const userInfo = document.getElementById('userInfo');
                    const userName = document.getElementById('userName');
                    const userRole = document.getElementById('userRole');
                    const userAvatar = document.getElementById('userAvatar');
                    
                    if (socialLinks) socialLinks.style.display = 'none';
                    if (userInfo) userInfo.style.display = 'flex';
                    if (userName) userName.textContent = currentUser.username;
                    if (userRole) userRole.textContent = currentUser.role === 'admin' ? 'ĞĞ´Ğ¼Ğ¸Ğ½Ğ¸ÑÑ‚Ñ€Ğ°Ñ‚Ğ¾Ñ€' : 'ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ';
                    if (userAvatar) userAvatar.textContent = currentUser.username.charAt(0).toUpperCase();
                } catch (error) {
                    console.error('ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¿Ğ¾ĞºĞ°Ğ·Ğ° Ğ¼ĞµĞ½Ñ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ:', error);
                }
            }

            // ĞœĞ¾Ğ´Ğ°Ğ»ÑŒĞ½Ñ‹Ğµ Ğ¾ĞºĞ½Ğ°
            function showLogin() {
                const loginModal = document.getElementById('loginModal');
                if (loginModal) loginModal.style.display = 'flex';
            }

            function closeModal() {
                document.querySelectorAll('.modal').forEach(modal => {
                    modal.style.display = 'none';
                });
            }

            // ĞŸĞµÑ€ĞµĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğ¼ĞµÑ‚Ğ¾Ğ´Ğ° Ğ¾Ğ¿Ğ»Ğ°Ñ‚Ñ‹
            function switchPaymentMethod(method) {
                currentPaymentMethod = method;

                // ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½ÑƒÑ Ğ²ĞºĞ»Ğ°Ğ´ĞºÑƒ
                document.querySelectorAll('.method-tab').forEach(tab => {
                    tab.classList.remove('active');
                });
                
                const cardTab = document.getElementById('cardTab');
                const cryptoTab = document.getElementById('cryptoTab');
                const cardPayment = document.getElementById('cardPayment');
                const cryptoPayment = document.getElementById('cryptoPayment');
                
                if (method === 'card') {
                    if (cardTab) cardTab.classList.add('active');
                    if (cardPayment) cardPayment.style.display = 'block';
                    if (cryptoPayment) cryptoPayment.style.display = 'none';
                } else {
                    if (cryptoTab) cryptoTab.classList.add('active');
                    if (cardPayment) cardPayment.style.display = 'none';
                    if (cryptoPayment) cryptoPayment.style.display = 'block';
                    updateCryptoAmounts();
                }
            }

            // ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ ĞºÑ€Ğ¸Ğ¿Ñ‚Ğ¾ ÑÑƒĞ¼Ğ¼
            function updateCryptoAmounts() {
                if (currentPurchase) {
                    const rubAmount = currentPurchase.finalPrice || currentPurchase.price;
                    const usdtAmount = (rubAmount / cryptoRates.USDT).toFixed(6);
                    const tonAmount = (rubAmount / cryptoRates.TON).toFixed(6);

                    const usdtEl = document.getElementById('usdtAmount');
                    const tonEl = document.getElementById('tonAmount');
                    const botLink = document.getElementById('cryptoBotLink');
                    
                    if (usdtEl) usdtEl.textContent = usdtAmount;
                    if (tonEl) tonEl.textContent = tonAmount;
                    if (botLink) botLink.href = `http://t.me/send?start=IVKF2M5j40O5&amount=${rubAmount}`;
                }
            }

            // ĞĞ²Ñ‚Ğ¾Ñ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ
            function performLogin() {
                const username = document.getElementById('loginUsername');
                const password = document.getElementById('loginPassword');
                
                if (!username || !password) return;
                
                const user = users.find(u => u.username === username.value && u.password === password.value);

                if (user) {
                    currentUser = user;
                    localStorage.setItem('currentUser', JSON.stringify(user));
                    showUserMenu();
                    closeModal();

                    updateStatsVisibility();

                    if (user.role === 'admin') {
                        const adminPanel = document.getElementById('adminPanel');
                        if (adminPanel) adminPanel.style.display = 'block';
                        loadCountryControls();
                        loadPromoCodes();
                    }
                    showNotification('Ğ£ÑĞ¿ĞµÑˆĞ½Ñ‹Ğ¹ Ğ²Ñ…Ğ¾Ğ´ Ğ² ÑĞ¸ÑÑ‚ĞµĞ¼Ñƒ!', 'success');
                } else {
                    showNotification('ĞĞµĞ²ĞµÑ€Ğ½Ñ‹Ğ¹ Ğ»Ğ¾Ğ³Ğ¸Ğ½ Ğ¸Ğ»Ğ¸ Ğ¿Ğ°Ñ€Ğ¾Ğ»ÑŒ', 'error');
                }
            }

            // Ğ’Ñ‹Ñ…Ğ¾Ğ´
            function logout() {
                currentUser = null;
                localStorage.removeItem('currentUser');
                
                const socialLinks = document.querySelector('.social-links');
                const userInfo = document.getElementById('userInfo');
                const adminPanel = document.getElementById('adminPanel');
                const statsSection = document.getElementById('statsSection');
                
                if (socialLinks) socialLinks.style.display = 'flex';
                if (userInfo) userInfo.style.display = 'none';
                if (adminPanel) adminPanel.style.display = 'none';
                if (statsSection) statsSection.style.display = 'none';
                
                showNotification('Ğ’Ñ‹ Ğ²Ñ‹ÑˆĞ»Ğ¸ Ğ¸Ğ· ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹', 'success');
            }

            // ĞŸÑ€Ğ¸Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ğ¼Ğ¾ĞºĞ¾Ğ´Ğ°
            function applyPromoCode() {
                const promoCodeInput = document.getElementById('promoCodeInput');
                const promoMessage = document.getElementById('promoMessage');
                
                if (!promoCodeInput || !promoMessage) return;
                
                const promoCode = promoCodeInput.value.trim().toUpperCase();

                if (!promoCode) {
                    showNotification('Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ğ¿Ñ€Ğ¾Ğ¼Ğ¾ĞºĞ¾Ğ´', 'warning');
                    return;
                }

                const promo = promoCodes.find(p => p.code === promoCode);

                if (!promo) {
                    promoMessage.innerHTML = '<div style="color: var(--danger);">ĞŸÑ€Ğ¾Ğ¼Ğ¾ĞºĞ¾Ğ´ Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½</div>';
                    promoMessage.style.display = 'block';
                    return;
                }

                const now = new Date();
                const expiresAt = new Date(promo.expiresAt);

                if (expiresAt < now) {
                    promoMessage.innerHTML = '<div style="color: var(--danger);">ĞŸÑ€Ğ¾Ğ¼Ğ¾ĞºĞ¾Ğ´ Ğ¸ÑÑ‚ĞµĞº</div>';
                    promoMessage.style.display = 'block';
                    return;
                }

                if (promo.used >= promo.maxUses) {
                    promoMessage.innerHTML = '<div style="color: var(--danger);">ĞŸÑ€Ğ¾Ğ¼Ğ¾ĞºĞ¾Ğ´ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½ Ğ¿Ğ¾Ğ»Ğ½Ğ¾ÑÑ‚ÑŒÑ</div>';
                    promoMessage.style.display = 'block';
                    return;
                }

                // Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ÑĞµĞ¼ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹Ğ¹ Ğ¿Ñ€Ğ¾Ğ¼Ğ¾ĞºĞ¾Ğ´
                activePromoCode = promo;
                appliedDiscount = promo.discount;

                // ĞŸĞ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµĞ¼ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ Ğ¾Ğ± ÑƒÑĞ¿ĞµÑ…Ğµ
                promoMessage.innerHTML = `
                    <div style="color: var(--success); font-weight: 600;">
                        âœ“ ĞŸÑ€Ğ¾Ğ¼Ğ¾ĞºĞ¾Ğ´ Ğ¿Ñ€Ğ¸Ğ¼ĞµĞ½ĞµĞ½! Ğ¡ĞºĞ¸Ğ´ĞºĞ° ${promo.discount}%
                    </div>
                `;
                promoMessage.style.display = 'block';

                // ĞÑ‡Ğ¸Ñ‰Ğ°ĞµĞ¼ Ğ¿Ğ¾Ğ»Ğµ Ğ²Ğ²Ğ¾Ğ´Ğ°
                promoCodeInput.value = '';

                showNotification(`ĞŸÑ€Ğ¾Ğ¼Ğ¾ĞºĞ¾Ğ´ "${promo.code}" Ğ¿Ñ€Ğ¸Ğ¼ĞµĞ½ĞµĞ½! Ğ¡ĞºĞ¸Ğ´ĞºĞ° ${promo.discount}%`, 'promo');
            }

            // Ğ¡Ğ±Ñ€Ğ¾Ñ Ğ¿Ñ€Ğ¾Ğ¼Ğ¾ĞºĞ¾Ğ´Ğ°
            function resetPromoCode() {
                activePromoCode = null;
                appliedDiscount = 0;
                const promoMessage = document.getElementById('promoMessage');
                if (promoMessage) {
                    promoMessage.innerHTML = '';
                    promoMessage.style.display = 'none';
                }
            }

            // ĞŸĞ¾ĞºÑƒĞ¿ĞºĞ° Ğ°ĞºĞºĞ°ÑƒĞ½Ñ‚Ğ°
            function buyAccount(country, type, key) {
                const prices = JSON.parse(localStorage.getItem('countryPrices') || '{}');
                let price = 0;
                let accountName = country;

                // ĞĞ¿Ñ€ĞµĞ´ĞµĞ»ÑĞµĞ¼ Ñ†ĞµĞ½Ñƒ
                if (key.includes('premium')) {
                    const premiumAccount = premiumAccounts.find(a => a.id === key);
                    if (premiumAccount) {
                        price = premiumAccount.price;
                        accountName = premiumAccount.country + ' ĞŸÑ€ĞµĞ¼Ğ¸ÑƒĞ¼';
                    }
                } else if (key === 'usa-ot') {
                    price = 50;
                } else if (key === 'india-ot') {
                    price = 25;
                } else {
                    price = prices[key] || allCountries.find(c => c.key === key)?.price || 0;
                }

                // Ğ Ğ°ÑÑÑ‡Ğ¸Ñ‚Ñ‹Ğ²Ğ°ĞµĞ¼ Ğ¸Ñ‚Ğ¾Ğ³Ğ¾Ğ²ÑƒÑ Ñ†ĞµĞ½Ñƒ Ñ ÑƒÑ‡ĞµÑ‚Ğ¾Ğ¼ ÑĞºĞ¸Ğ´ĞºĞ¸
                let finalPrice = price;
                if (activePromoCode && appliedDiscount > 0) {
                    finalPrice = Math.round(price * (100 - appliedDiscount) / 100);
                }

                currentPurchase = {
                    id: Date.now(),
                    country: accountName,
                    type: type,
                    price: price,
                    finalPrice: finalPrice,
                    user: 'ĞŸĞ¾ĞºÑƒĞ¿Ğ°Ñ‚ĞµĞ»ÑŒ',
                    date: new Date().toLocaleString(),
                    timestamp: Date.now(),
                    paymentMethod: 'card',
                    accountKey: key,
                    promoCode: activePromoCode ? activePromoCode.code : null,
                    discount: appliedDiscount
                };

                // ĞĞ±Ğ½Ğ¾Ğ²Ğ»ÑĞµĞ¼ Ğ¾Ñ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğµ Ñ†ĞµĞ½Ñ‹ Ğ² Ğ¼Ğ¾Ğ´Ğ°Ğ»ÑŒĞ½Ğ¾Ğ¼ Ğ¾ĞºĞ½Ğµ
                updatePaymentModalDisplay();
                
                const paymentModal = document.getElementById('paymentModal');
                if (paymentModal) paymentModal.style.display = 'flex';

                // Ğ¡Ğ±Ñ€Ğ¾ÑĞ¸Ñ‚ÑŒ Ğ¼ĞµÑ‚Ğ¾Ğ´ Ğ¾Ğ¿Ğ»Ğ°Ñ‚Ñ‹ Ğº ĞºĞ°Ñ€Ñ‚Ğµ
                switchPaymentMethod('card');
            }

            // ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ¾Ñ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ Ğ² Ğ¼Ğ¾Ğ´Ğ°Ğ»ÑŒĞ½Ğ¾Ğ¼ Ğ¾ĞºĞ½Ğµ Ğ¾Ğ¿Ğ»Ğ°Ñ‚Ñ‹
            function updatePaymentModalDisplay() {
                if (!currentPurchase) return;

                const originalPrice = currentPurchase.price;
                const finalPrice = currentPurchase.finalPrice;
                const hasDiscount = appliedDiscount > 0;

                // ĞÑ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶Ğ°ĞµĞ¼ ÑĞºĞ¸Ğ´ĞºÑƒ ĞµÑĞ»Ğ¸ ĞµÑÑ‚ÑŒ
                const discountDisplay = document.getElementById('discountDisplay');
                const activePromoCodeEl = document.getElementById('activePromoCode');
                const discountPercentageEl = document.getElementById('discountPercentage');
                const originalPriceEl = document.getElementById('originalPrice');
                const originalPriceValueEl = document.getElementById('originalPriceValue');
                const savingsBadgeEl = document.getElementById('savingsBadge');
                const paymentAmountEl = document.getElementById('paymentAmount');
                
                if (hasDiscount) {
                    if (discountDisplay) discountDisplay.style.display = 'block';
                    if (activePromoCodeEl) activePromoCodeEl.textContent = activePromoCode.code;
                    if (discountPercentageEl) discountPercentageEl.textContent = appliedDiscount;
                    if (originalPriceEl) originalPriceEl.style.display = 'block';
                    if (originalPriceValueEl) originalPriceValueEl.textContent = originalPrice + 'P';
                    if (savingsBadgeEl) savingsBadgeEl.textContent = `-${originalPrice - finalPrice}P`;
                } else {
                    if (discountDisplay) discountDisplay.style.display = 'none';
                    if (originalPriceEl) originalPriceEl.style.display = 'none';
                }

                // ĞĞ±Ğ½Ğ¾Ğ²Ğ»ÑĞµĞ¼ Ğ¾ÑĞ½Ğ¾Ğ²Ğ½ÑƒÑ Ñ†ĞµĞ½Ñƒ
                if (paymentAmountEl) paymentAmountEl.textContent = finalPrice + 'P';

                // ĞĞ±Ğ½Ğ¾Ğ²Ğ»ÑĞµĞ¼ ĞºÑ€Ğ¸Ğ¿Ñ‚Ğ¾ ÑÑƒĞ¼Ğ¼Ñ‹
                updateCryptoAmounts();
            }

            // Ğ—Ğ°ĞºÑ€Ñ‹Ñ‚Ğ¸Ğµ Ğ¼Ğ¾Ğ´Ğ°Ğ»ÑŒĞ½Ñ‹Ñ… Ğ¾ĞºĞ¾Ğ½ Ğ¿Ñ€Ğ¸ ĞºĞ»Ğ¸ĞºĞµ Ğ²Ğ½Ğµ Ğ¸Ñ…
            window.onclick = function(event) {
                if (event.target.classList.contains('modal')) {
                    closeModal();
                }
            };

            // ĞĞ²Ñ‚Ğ¾Ğ·Ğ°ĞºÑ€Ñ‹Ñ‚Ğ¸Ğµ Ğ¼Ğ¾Ğ´Ğ°Ğ»ÑŒĞ½Ñ‹Ñ… Ğ¾ĞºĞ¾Ğ½ Ğ¿Ğ¾ ESC
            document.addEventListener('keydown', function(event) {
                if (event.key === 'Escape') {
                    closeModal();
                }
            });

            // ĞŸÑĞµĞ²Ğ´Ğ¾Ğ½Ğ¸Ğ¼ Ğ´Ğ»Ñ ÑĞ¾Ğ²Ğ¼ĞµÑÑ‚Ğ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ Ñ ĞºĞ½Ğ¾Ğ¿ĞºĞ¾Ğ¹ "Ğ¯ Ğ¾Ğ¿Ğ»Ğ°Ñ‚Ğ¸Ğ»"
            function showGeneratedCodeModal() {
                showGeneratedCodeModalFromButton();
            }

            // Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ñ Ğ´Ğ»Ñ Ğ¿Ñ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€Ğ° ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ½Ñ‹Ñ… ĞºĞ¾Ğ´Ğ¾Ğ² (Ğ´Ğ»Ñ Ğ¾Ñ‚Ğ»Ğ°Ğ´ĞºĞ¸)
            function viewSavedCodes() {
                const codes = JSON.parse(localStorage.getItem('nezeex_codes') || '[]');
                console.log('Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ½Ñ‹Ğµ ĞºĞ¾Ğ´Ñ‹:', codes);
                alert(`Ğ’ÑĞµĞ³Ğ¾ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¾ ĞºĞ¾Ğ´Ğ¾Ğ²: ${codes.length}\n\nĞŸĞ¾ÑĞ¼Ğ¾Ñ‚Ñ€ĞµÑ‚ÑŒ Ğ² ĞºĞ¾Ğ½ÑĞ¾Ğ»Ğ¸ Ğ±Ñ€Ğ°ÑƒĞ·ĞµÑ€Ğ° (F12)`);
            }
        </script>
    </div>
</body>
</html>
